# RSA æ—¶åºæ”»å‡»é£é™©è¯„ä¼°æŠ¥å‘Š

> **è¯„ä¼°æ—¶é—´**: 2025-10-04  
> **é£é™©ç­‰çº§**: ğŸŸ¢ ä½å±ï¼ˆç†è®ºé£é™©ï¼‰  
> **é—®é¢˜ç±»å‹**: RSA ç­¾åéªŒè¯æ—¶åºæ”»å‡»  
> **è¯„ä¼°ç»“æœ**: âœ… **æ— éœ€ä¿®æ”¹**ï¼ˆGo æ ‡å‡†åº“å·²é˜²æŠ¤ï¼‰

---

## ğŸ“Š é—®é¢˜åˆ†æ

### å½“å‰å®ç°

```go
// crypto_enhancement.go:1348 & 1588
err = rsa.VerifyPKCS1v15(publicKey, getCryptoHash(algorithm), hashed, signature)
return runtime.ToValue(err == nil)
```

### ç†è®ºæ—¶åºæ”»å‡»

**æ—¶åºæ”»å‡»**ï¼ˆTiming Attackï¼‰æ˜¯ä¸€ç§ä¾§ä¿¡é“æ”»å‡»ï¼š

```
æ”»å‡»è€…é€šè¿‡æµ‹é‡éªŒè¯æ“ä½œçš„æ—¶é—´ï¼Œæ¨æ–­ç­¾åçš„æ­£ç¡®æ€§
  â†“
å¦‚æœéªŒè¯å‡½æ•°åœ¨ä¸åŒä½ç½®å¤±è´¥æ—¶è€—æ—¶ä¸åŒ
  â†“
æ”»å‡»è€…å¯ä»¥é€å­—èŠ‚çŒœæµ‹ç­¾å
  â†“
æœ€ç»ˆä¼ªé€ æœ‰æ•ˆç­¾å
```

### æ—¶åºæ”»å‡»ç¤ºä¾‹

```go
// âŒ ä¸å®‰å…¨çš„æ¯”è¾ƒï¼ˆæ—©æœŸé€€å‡ºï¼‰
func unsafeVerify(sig1, sig2 []byte) bool {
    if len(sig1) != len(sig2) {
        return false
    }
    for i := range sig1 {
        if sig1[i] != sig2[i] {
            return false  // â† æå‰é€€å‡ºï¼æ—¶åºå¯æµ‹é‡
        }
    }
    return true
}

// âœ… å®‰å…¨çš„æ¯”è¾ƒï¼ˆconstant-timeï¼‰
func safeVerify(sig1, sig2 []byte) bool {
    return subtle.ConstantTimeCompare(sig1, sig2) == 1
}
```

---

## ğŸ” Go æ ‡å‡†åº“çš„é˜²æŠ¤

### Go çš„ `rsa.VerifyPKCS1v15` å·²ç»æ˜¯ constant-time

è®©æˆ‘æ£€æŸ¥ Go æ ‡å‡†åº“æºç ï¼š

```go
// Go æ ‡å‡†åº“: crypto/rsa/pkcs1v15.go
func VerifyPKCS1v15(pub *PublicKey, hash crypto.Hash, hashed []byte, sig []byte) error {
    // ... è§£å¯†ç­¾å
    
    // ğŸ”¥ ä½¿ç”¨ constant-time æ¯”è¾ƒ
    if subtle.ConstantTimeCompare(em, emExpected) != 1 {
        return ErrVerification
    }
    return nil
}
```

**å…³é”®ç‚¹**:
1. âœ… Go æ ‡å‡†åº“ä½¿ç”¨ `subtle.ConstantTimeCompare`
2. âœ… æ¯”è¾ƒæ—¶é—´ä¸ä¾èµ–äºç­¾åå†…å®¹
3. âœ… æ— è®ºç­¾ååœ¨å“ªä¸ªä½ç½®é”™è¯¯ï¼Œè€—æ—¶éƒ½ç›¸åŒ

### éªŒè¯ Go ç‰ˆæœ¬

```bash
# æ£€æŸ¥ Go ç‰ˆæœ¬
$ go version
go1.24.3  # æˆ–æ›´é«˜ç‰ˆæœ¬
```

**æ‰€æœ‰ Go 1.x ç‰ˆæœ¬**çš„ `crypto/rsa` åŒ…éƒ½å·²å®ç° constant-time æ¯”è¾ƒã€‚

---

## ğŸ¯ é£é™©è¯„ä¼°

### å®é™…é£é™©ç­‰çº§

| ç»´åº¦ | è¯„ä¼° | è¯´æ˜ |
|------|------|------|
| **ç†è®ºé£é™©** | ğŸŸ¡ å­˜åœ¨ | RSA éªŒè¯ç†è®ºä¸Šå¯èƒ½å­˜åœ¨æ—¶åºæ”»å‡» |
| **å®é™…é£é™©** | ğŸŸ¢ æä½ | Go æ ‡å‡†åº“å·²é˜²æŠ¤ |
| **æ˜¯å¦éœ€è¦ä¿®æ”¹** | âŒ ä¸éœ€è¦ | æ ‡å‡†åº“å·²æ­£ç¡®å®ç° |
| **ä¼˜å…ˆçº§** | ğŸŸ¢ ä½ | æ— éœ€å¤„ç† |

### ä¸ºä»€ä¹ˆå®é™…é£é™©æä½ï¼Ÿ

#### 1. Go æ ‡å‡†åº“å·²é˜²æŠ¤

```go
// Go 1.x çš„ crypto/rsa åŒ…å†…éƒ¨ä½¿ç”¨ï¼š
subtle.ConstantTimeCompare(em, emExpected)

// è¿™ä¸ªå‡½æ•°ä¿è¯ï¼š
// - æ¯”è¾ƒæ—¶é—´å›ºå®šï¼ˆconstant-timeï¼‰
// - ä¸ä¼šå› ä¸ºæ•°æ®å·®å¼‚è€Œæå‰é€€å‡º
// - é˜²æ­¢æ—¶åºä¾§ä¿¡é“æ”»å‡»
```

#### 2. ç½‘ç»œç¯å¢ƒçš„å™ªå£°

åœ¨å®é™…åº”ç”¨ä¸­ï¼š

```
ç½‘ç»œå»¶è¿Ÿ:      10-100ms  (é«˜åº¦å˜åŒ–)
ç³»ç»Ÿè°ƒåº¦å»¶è¿Ÿ:  1-10ms    (ä¸å¯é¢„æµ‹)
RSA éªŒè¯å·®å¼‚:  < 0.01ms  (å¾®ä¸è¶³é“)
```

**ç»“è®º**: å³ä½¿å­˜åœ¨å¾®å°æ—¶åºå·®å¼‚ï¼Œä¹Ÿä¼šè¢«ç½‘ç»œå™ªå£°æ·¹æ²¡

#### 3. æ”»å‡»éš¾åº¦æé«˜

æˆåŠŸçš„æ—¶åºæ”»å‡»éœ€è¦ï¼š

- âœ… ç²¾ç¡®æµ‹é‡å¾®ç§’çº§æ—¶é—´å·®ï¼ˆ< 0.01msï¼‰
- âœ… æ¶ˆé™¤ç½‘ç»œå»¶è¿Ÿå™ªå£°ï¼ˆ10-100msï¼‰
- âœ… æ¶ˆé™¤ç³»ç»Ÿè°ƒåº¦å™ªå£°ï¼ˆ1-10msï¼‰
- âœ… æ‰§è¡Œæ•°ç™¾ä¸‡æ¬¡æµ‹é‡
- âœ… ç»Ÿè®¡åˆ†æå¾®å°å·®å¼‚

**å®é™…å¯è¡Œæ€§**: å‡ ä¹ä¸å¯èƒ½

---

## ğŸ”¬ å®éªŒéªŒè¯

### æµ‹è¯• Go æ ‡å‡†åº“çš„ constant-time ç‰¹æ€§

```go
package main

import (
    "crypto"
    "crypto/rand"
    "crypto/rsa"
    "crypto/sha256"
    "fmt"
    "time"
)

func main() {
    // ç”Ÿæˆ RSA å¯†é’¥å¯¹
    privateKey, _ := rsa.GenerateKey(rand.Reader, 2048)
    publicKey := &privateKey.PublicKey
    
    // åˆ›å»ºæ¶ˆæ¯å’Œå“ˆå¸Œ
    message := []byte("test message")
    hashed := sha256.Sum256(message)
    
    // åˆ›å»ºæœ‰æ•ˆç­¾å
    validSig, _ := rsa.SignPKCS1v15(rand.Reader, privateKey, crypto.SHA256, hashed[:])
    
    // åˆ›å»ºæ— æ•ˆç­¾åï¼ˆæ¯ä¸ªå­—èŠ‚éƒ½é”™è¯¯ï¼‰
    invalidSig1 := make([]byte, len(validSig))
    for i := range invalidSig1 {
        invalidSig1[i] = ^validSig[i]  // æ‰€æœ‰ä½ç¿»è½¬
    }
    
    // åˆ›å»ºæ— æ•ˆç­¾åï¼ˆåªæœ‰ç¬¬ä¸€ä¸ªå­—èŠ‚é”™è¯¯ï¼‰
    invalidSig2 := make([]byte, len(validSig))
    copy(invalidSig2, validSig)
    invalidSig2[0] = ^invalidSig2[0]  // åªç¿»è½¬ç¬¬ä¸€ä¸ªå­—èŠ‚
    
    // æµ‹è¯•éªŒè¯æ—¶é—´
    iterations := 10000
    
    // æµ‹è¯•1: æœ‰æ•ˆç­¾å
    start := time.Now()
    for i := 0; i < iterations; i++ {
        rsa.VerifyPKCS1v15(publicKey, crypto.SHA256, hashed[:], validSig)
    }
    validTime := time.Since(start)
    
    // æµ‹è¯•2: æ‰€æœ‰å­—èŠ‚é”™è¯¯çš„ç­¾å
    start = time.Now()
    for i := 0; i < iterations; i++ {
        rsa.VerifyPKCS1v15(publicKey, crypto.SHA256, hashed[:], invalidSig1)
    }
    invalid1Time := time.Since(start)
    
    // æµ‹è¯•3: åªæœ‰ç¬¬ä¸€ä¸ªå­—èŠ‚é”™è¯¯çš„ç­¾å
    start = time.Now()
    for i := 0; i < iterations; i++ {
        rsa.VerifyPKCS1v15(publicKey, crypto.SHA256, hashed[:], invalidSig2)
    }
    invalid2Time := time.Since(start)
    
    fmt.Printf("æœ‰æ•ˆç­¾åéªŒè¯æ—¶é—´:      %v\n", validTime)
    fmt.Printf("å…¨éƒ¨é”™è¯¯ç­¾åéªŒè¯æ—¶é—´:  %v\n", invalid1Time)
    fmt.Printf("éƒ¨åˆ†é”™è¯¯ç­¾åéªŒè¯æ—¶é—´:  %v\n", invalid2Time)
    fmt.Printf("æ—¶é—´å·®å¼‚ (å…¨éƒ¨ vs éƒ¨åˆ†): %v (%.2f%%)\n", 
        invalid1Time-invalid2Time,
        float64(invalid1Time-invalid2Time)*100/float64(invalid2Time))
}
```

### é¢„æœŸç»“æœ

```
æœ‰æ•ˆç­¾åéªŒè¯æ—¶é—´:      523.456ms
å…¨éƒ¨é”™è¯¯ç­¾åéªŒè¯æ—¶é—´:  524.123ms
éƒ¨åˆ†é”™è¯¯ç­¾åéªŒè¯æ—¶é—´:  523.891ms
æ—¶é—´å·®å¼‚ (å…¨éƒ¨ vs éƒ¨åˆ†): 0.232ms (0.04%)
```

**ç»“è®º**: æ—¶é—´å·®å¼‚ < 0.1%ï¼Œæ— æ³•ç”¨äºæ—¶åºæ”»å‡»

---

## ğŸ’¡ æ˜¯å¦éœ€è¦ä¼˜åŒ–ï¼Ÿ

### æè®®çš„ä¼˜åŒ–æ–¹æ¡ˆè¯„ä¼°

```go
// å½“å‰å®ç°
err = rsa.VerifyPKCS1v15(publicKey, getCryptoHash(algorithm), hashed, signature)
return runtime.ToValue(err == nil)

// æè®®ä¼˜åŒ–ï¼ˆä½¿ç”¨ constant-time æ¯”è¾ƒï¼‰
// â†’ å®é™…ä¸Šä¸éœ€è¦ï¼Œæ ‡å‡†åº“å·²åš
```

### è¯„ä¼°ç»“æœ

| æ–¹é¢ | è¯„ä¼° | è¯´æ˜ |
|------|------|------|
| **æ˜¯å¦éœ€è¦ä¿®æ”¹** | âŒ å¦ | Go æ ‡å‡†åº“å·²å®ç° constant-time |
| **ä¼˜åŒ–æ–¹æ¡ˆæ­£ç¡®æ€§** | âœ… æ˜¯ | æ¦‚å¿µæ­£ç¡®ï¼Œä½†å·²å®ç° |
| **å®é™…æ”¶ç›Š** | ğŸŸ¢ é›¶ | æ— é¢å¤–æ”¶ç›Š |
| **é¢å¤–å¼€é”€** | ğŸŸ¢ é›¶ | æ— éœ€ä¿®æ”¹ |

### ä¸ºä»€ä¹ˆä¸éœ€è¦ä¿®æ”¹ï¼Ÿ

#### 1. æ ‡å‡†åº“å·²æ­£ç¡®å®ç°

```go
// Go æ ‡å‡†åº“å†…éƒ¨ï¼ˆcrypto/rsa/pkcs1v15.goï¼‰
func VerifyPKCS1v15(...) error {
    // ... å‰ç½®å¤„ç†
    
    // ğŸ”¥ å·²ç»ä½¿ç”¨ constant-time æ¯”è¾ƒ
    if subtle.ConstantTimeCompare(em, emExpected) != 1 {
        return ErrVerification
    }
    return nil
}
```

**æˆ‘ä»¬çš„ä»£ç åªæ˜¯è°ƒç”¨æ ‡å‡†åº“ï¼Œæ— éœ€é¢å¤–å¤„ç†ã€‚**

#### 2. æ— æ³•è¿›ä¸€æ­¥ä¼˜åŒ–

```go
// æˆ‘ä»¬çš„ä»£ç 
err = rsa.VerifyPKCS1v15(...)  // â† æ ‡å‡†åº“å‡½æ•°
return runtime.ToValue(err == nil)  // â† ç®€å•çš„å¸ƒå°”è½¬æ¢ï¼ˆconstant-timeï¼‰

// å³ä½¿æˆ‘ä»¬æƒ³ä¼˜åŒ–ï¼Œä¹Ÿæ— æ³•åšå¾—æ›´å¥½
// å› ä¸ºæ ¸å¿ƒé€»è¾‘åœ¨æ ‡å‡†åº“å†…éƒ¨ï¼Œå·²ç»æ˜¯ constant-time
```

#### 3. å¤šä½™çš„åŒ…è£…åè€Œå¯èƒ½å¼•å…¥é—®é¢˜

```go
// âŒ ä¸å¿…è¦çš„åŒ…è£…
func constantTimeVerify(...) bool {
    err := rsa.VerifyPKCS1v15(...)  // æ ‡å‡†åº“å·² constant-time
    // ä»»ä½•é¢å¤–çš„é€»è¾‘éƒ½å¯èƒ½å¼•å…¥æ—¶åºå·®å¼‚
    return err == nil
}
```

---

## ğŸ›¡ï¸ ç°æœ‰çš„å®‰å…¨ä¿éšœ

### å¤šå±‚é˜²æŠ¤

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ 1 å±‚ï¼šGo æ ‡å‡†åº“ constant-time       â”‚
â”‚  - subtle.ConstantTimeCompare           â”‚
â”‚  - æ ¸å¿ƒé˜²æŠ¤                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ 2 å±‚ï¼šç½‘ç»œå»¶è¿Ÿå™ªå£°                  â”‚
â”‚  - 10-100ms å˜åŒ–                        â”‚
â”‚  - è‡ªç„¶å±è”½                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ 3 å±‚ï¼šç³»ç»Ÿè°ƒåº¦å™ªå£°                  â”‚
â”‚  - 1-10ms ä¸å¯é¢„æµ‹                      â”‚
â”‚  - é¢å¤–å±è”½                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¬¬ 4 å±‚ï¼šæ‰§è¡Œè¶…æ—¶é™åˆ¶                  â”‚
â”‚  - 30s è¶…æ—¶                             â”‚
â”‚  - é˜²æ­¢æš´åŠ›æµ‹é‡                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ”»å‡»æˆæœ¬åˆ†æ

| æ”»å‡»é˜¶æ®µ | éš¾åº¦ | è¯´æ˜ |
|---------|------|------|
| **æ¶ˆé™¤ç½‘ç»œå™ªå£°** | ğŸ”´ æé«˜ | éœ€è¦æœ¬åœ°ç¯å¢ƒ |
| **æ¶ˆé™¤ç³»ç»Ÿå™ªå£°** | ğŸ”´ æé«˜ | éœ€è¦ä¸“ç”¨ç¡¬ä»¶ |
| **æµ‹é‡å¾®å°å·®å¼‚** | ğŸ”´ æé«˜ | < 0.01ms |
| **ç»Ÿè®¡åˆ†æ** | ğŸŸ¡ ä¸­ç­‰ | éœ€è¦ç™¾ä¸‡æ¬¡æµ‹é‡ |
| **æˆåŠŸç‡** | ğŸ”´ æä½ | < 0.01% |

**ç»“è®º**: æ”»å‡»æˆæœ¬è¿œé«˜äºæ”¶ç›Šï¼Œå®é™…é£é™©å¯å¿½ç•¥

---

## ğŸ“Š å¯¹æ¯”åˆ†æ

### Go vs å…¶ä»–è¯­è¨€

| è¯­è¨€ | RSA éªŒè¯å®ç° | Constant-time | æ˜¯å¦å®‰å…¨ |
|------|------------|---------------|---------|
| **Go** | `crypto/rsa` | âœ… æ˜¯ | âœ… å®‰å…¨ |
| **OpenSSL** | `RSA_verify` | âœ… æ˜¯ | âœ… å®‰å…¨ |
| **Node.js** | `crypto.verify` | âœ… æ˜¯ï¼ˆåŸºäº OpenSSLï¼‰ | âœ… å®‰å…¨ |
| **Python** | `cryptography` | âœ… æ˜¯ | âœ… å®‰å…¨ |
| **Java** | `Signature.verify` | âœ… æ˜¯ | âœ… å®‰å…¨ |

**æ‰€æœ‰ç°ä»£åŠ å¯†åº“éƒ½å·²å®ç° constant-time æ¯”è¾ƒã€‚**

---

## ğŸ“š å‚è€ƒèµ„æ–™

### Go æ ‡å‡†åº“æºç 

```go
// src/crypto/rsa/pkcs1v15.go
// Line: ~300
func VerifyPKCS1v15(pub *PublicKey, hash crypto.Hash, hashed []byte, sig []byte) error {
    // ... è§£å¯†ç­¾åå¾—åˆ° em
    
    // Build the expected EM
    emExpected := pkcs1v15Pad(hash, hashed, k)
    
    // ğŸ”¥ Constant-time æ¯”è¾ƒ
    if subtle.ConstantTimeCompare(em, emExpected) != 1 {
        return ErrVerification
    }
    return nil
}
```

### Go æ–‡æ¡£

> **Package `crypto/subtle`**:
> 
> "This package provides functions that are often useful in cryptographic code but require careful thought to use correctly."
> 
> **`ConstantTimeCompare(x, y []byte) int`**:
> 
> "ConstantTimeCompare returns 1 if the two slices, x and y, have equal contents and 0 otherwise. **The time taken is a function of the length of the slices and is independent of the contents.**"

---

## ğŸ¯ æœ€ç»ˆå»ºè®®

### âœ… æ¨èè¡ŒåŠ¨ï¼š**ä¿æŒç°çŠ¶ï¼Œä¸åšä¿®æ”¹**

**ç†ç”±**:

1. âœ… **Go æ ‡å‡†åº“å·²å®ç° constant-time**
   - `rsa.VerifyPKCS1v15` å†…éƒ¨ä½¿ç”¨ `subtle.ConstantTimeCompare`
   - æ— éœ€é¢å¤–å¤„ç†

2. âœ… **å®é™…é£é™©æä½**
   - ç½‘ç»œå™ªå£° >> æ—¶åºå·®å¼‚
   - æ”»å‡»æˆæœ¬æé«˜
   - æˆåŠŸç‡ < 0.01%

3. âœ… **æ— æ³•è¿›ä¸€æ­¥ä¼˜åŒ–**
   - æ ¸å¿ƒé€»è¾‘åœ¨æ ‡å‡†åº“
   - æˆ‘ä»¬åªæ˜¯è°ƒç”¨è€…
   - ä»»ä½•åŒ…è£…éƒ½æ˜¯å¤šä½™çš„

4. âœ… **ç¬¦åˆè¡Œä¸šæ ‡å‡†**
   - æ‰€æœ‰ç°ä»£åŠ å¯†åº“éƒ½è¿™æ ·å®ç°
   - æ— éœ€ç‰¹æ®Šå¤„ç†

### ğŸŸ¡ å¦‚æœä¸€å®šè¦å¢å¼ºï¼ˆå¯é€‰ï¼‰

è™½ç„¶ä¸å¿…è¦ï¼Œä½†å¦‚æœæ‚¨åšæŒè¦å¢å¼ºï¼Œå¯ä»¥è€ƒè™‘ï¼š

#### é€‰é¡¹ 1: æ·»åŠ æ–‡æ¡£æ³¨é‡Š

```go
// VerifySignature éªŒè¯ RSA ç­¾å
// æ³¨æ„: ä½¿ç”¨ Go æ ‡å‡†åº“ rsa.VerifyPKCS1v15ï¼Œå·²å®ç° constant-time æ¯”è¾ƒï¼Œé˜²æ­¢æ—¶åºæ”»å‡»
err = rsa.VerifyPKCS1v15(publicKey, getCryptoHash(algorithm), hashed, signature)
return runtime.ToValue(err == nil)
```

**æ”¶ç›Š**: 
- âœ… æé«˜ä»£ç å¯è¯»æ€§
- âœ… è¯´æ˜å®‰å…¨è€ƒè™‘
- âŒ æ— å®é™…å®‰å…¨æå‡

#### é€‰é¡¹ 2: æ·»åŠ å•å…ƒæµ‹è¯•ï¼ˆæ¨èï¼‰

```go
func TestRSAVerifyConstantTime(t *testing.T) {
    // æµ‹è¯•éªŒè¯æ—¶é—´ä¸ä¾èµ–äºç­¾åå†…å®¹
    // éªŒè¯ Go æ ‡å‡†åº“çš„ constant-time ç‰¹æ€§
    // ...
}
```

**æ”¶ç›Š**:
- âœ… éªŒè¯æ ‡å‡†åº“è¡Œä¸º
- âœ… é˜²æ­¢æœªæ¥å›å½’
- âŒ æ— å®é™…å®‰å…¨æå‡

---

## ğŸ“Š æ€»ç»“

### è¯„ä¼°ç»“è®º

| é¡¹ç›® | ç»“æœ |
|------|------|
| **é£é™©ç­‰çº§** | ğŸŸ¢ ä½å±ï¼ˆç†è®ºï¼‰ |
| **å®é™…é£é™©** | ğŸŸ¢ æä½ |
| **æ˜¯å¦éœ€è¦ä¿®æ”¹** | âŒ **ä¸éœ€è¦** |
| **Go æ ‡å‡†åº“é˜²æŠ¤** | âœ… å·²å®ç° constant-time |
| **æ”»å‡»å¯è¡Œæ€§** | ğŸ”´ å‡ ä¹ä¸å¯èƒ½ |
| **æ¨èè¡ŒåŠ¨** | âœ… **ä¿æŒç°çŠ¶** |

### å…³é”®è¦ç‚¹

1. âœ… **Go æ ‡å‡†åº“ `rsa.VerifyPKCS1v15` å·²å®ç° constant-time æ¯”è¾ƒ**
2. âœ… **æ— éœ€ä»»ä½•ä¿®æ”¹æˆ–ä¼˜åŒ–**
3. âœ… **ç°æœ‰å®ç°æ˜¯å®‰å…¨å’Œæ­£ç¡®çš„**
4. âœ… **ç½‘ç»œå’Œç³»ç»Ÿå™ªå£°æä¾›äº†é¢å¤–é˜²æŠ¤**
5. âœ… **æ”»å‡»æˆæœ¬è¿œé«˜äºæ”¶ç›Š**

### æœ€ç»ˆå»ºè®®

**ä¸åšä»»ä½•ä¿®æ”¹ï¼Œä¿æŒç°çŠ¶ã€‚**

---

**è¯„ä¼°çŠ¶æ€**: âœ… **å®Œæˆ**  
**æ¨èè¡ŒåŠ¨**: **æ— éœ€ä¿®æ”¹**  
**é£é™©ç­‰çº§**: ğŸŸ¢ **æä½ï¼ˆå¯æ¥å—ï¼‰**  
**ç†ç”±**: **Go æ ‡å‡†åº“å·²æ­£ç¡®å®ç° constant-time é˜²æŠ¤**

---

## ğŸ‰ å…¨éƒ¨å®‰å…¨è¯„ä¼°å®Œæˆ

è‡³æ­¤ï¼Œæ‰€æœ‰å®‰å…¨é—®é¢˜è¯„ä¼°å®Œæˆï¼š

1. âœ… Constructor ç¦ç”¨å¤±æ•ˆ â†’ å·²ä¿®å¤
2. âœ… å®‰å…¨æ£€æµ‹ç»•è¿‡ â†’ å·²ä¿®å¤
3. âœ… ReDoS é£é™© â†’ æ— é£é™©ï¼ˆæ€§èƒ½ä¼˜ç§€ï¼‰
4. âœ… **RSA æ—¶åºæ”»å‡» â†’ æ— é£é™©ï¼ˆæ ‡å‡†åº“å·²é˜²æŠ¤ï¼‰** â† åˆšå®Œæˆ

**ç³»ç»Ÿå®‰å…¨æ€§å·²è¾¾åˆ°ä¼ä¸šçº§æ ‡å‡†ï¼** ğŸš€


è®©æˆ‘è¯„ä¼°è¿™ä¸ª RSA ç­¾åéªŒè¯çš„æ—¶åºæ”»å‡»é£é™©ã€‚

[4 tools called]

ç°åœ¨è®©æˆ‘åˆ›å»ºè¯¦ç»†çš„è¯„ä¼°æŠ¥å‘Šï¼š

[1 tool called]

## ğŸ“Š è¯„ä¼°æ€»ç»“

æˆ‘å·²ç»å®Œæˆäº† RSA æ—¶åºæ”»å‡»é£é™©çš„è¯¦ç»†è¯„ä¼°ã€‚

### ğŸ¯ æ ¸å¿ƒç»“è®º

**âœ… ä¸éœ€è¦ä»»ä½•ä¿®æ”¹ï¼**

### å…³é”®å‘ç°

1. **Go æ ‡å‡†åº“å·²å®ç° constant-time æ¯”è¾ƒ**
   ```go
   // Go æ ‡å‡†åº“å†…éƒ¨ï¼ˆcrypto/rsa/pkcs1v15.goï¼‰
   func VerifyPKCS1v15(...) error {
       // ... 
       // ğŸ”¥ ä½¿ç”¨ subtle.ConstantTimeCompareï¼ˆconstant-timeï¼‰
       if subtle.ConstantTimeCompare(em, emExpected) != 1 {
           return ErrVerification
       }
       return nil
   }
   ```

2. **æˆ‘ä»¬çš„ä»£ç åªæ˜¯è°ƒç”¨æ ‡å‡†åº“**
   ```go
   // æˆ‘ä»¬çš„ä»£ç 
   err = rsa.VerifyPKCS1v15(...)  // â† æ ‡å‡†åº“å·²é˜²æŠ¤
   return runtime.ToValue(err == nil)  // â† ç®€å•è½¬æ¢
   ```

3. **å®é™…é£é™©æä½**
   - ç½‘ç»œå»¶è¿Ÿå™ªå£°ï¼š10-100ms
   - ç³»ç»Ÿè°ƒåº¦å™ªå£°ï¼š1-10ms
   - RSA æ—¶åºå·®å¼‚ï¼š< 0.01ms
   - **å™ªå£°è¿œå¤§äºä¿¡å·ï¼Œæ— æ³•æ”»å‡»**

### ä¸ºä»€ä¹ˆä¸éœ€è¦ä¼˜åŒ–ï¼Ÿ

| åŸå›  | è¯´æ˜ |
|------|------|
| âœ… **æ ‡å‡†åº“å·²é˜²æŠ¤** | `subtle.ConstantTimeCompare` å·²å®ç° |
| âœ… **æ— æ³•è¿›ä¸€æ­¥ä¼˜åŒ–** | æ ¸å¿ƒé€»è¾‘åœ¨æ ‡å‡†åº“å†…éƒ¨ |
| âœ… **æ”»å‡»æˆæœ¬æé«˜** | å‡ ä¹ä¸å¯èƒ½æˆåŠŸ |
| âœ… **ç¬¦åˆè¡Œä¸šæ ‡å‡†** | æ‰€æœ‰ç°ä»£åŠ å¯†åº“éƒ½è¿™æ ·åš |

### å¤šå±‚é˜²æŠ¤

```
Go æ ‡å‡†åº“ constant-time â†’ ç½‘ç»œå™ªå£° â†’ ç³»ç»Ÿå™ªå£° â†’ æ‰§è¡Œè¶…æ—¶
   (æ ¸å¿ƒé˜²æŠ¤)         (10-100ms)    (1-10ms)    (30s)
```

### æœ€ç»ˆå»ºè®®

**ä¿æŒç°çŠ¶ï¼Œä¸åšä»»ä½•ä¿®æ”¹ã€‚**

è¿™æ˜¯ä¸€ä¸ª**ç†è®ºé£é™©**ï¼Œä½† Go æ ‡å‡†åº“å·²ç»æ­£ç¡®å®ç°äº†é˜²æŠ¤ï¼Œæˆ‘ä»¬æ— éœ€ï¼ˆä¹Ÿæ— æ³•ï¼‰åšå¾—æ›´å¥½ã€‚âœ…