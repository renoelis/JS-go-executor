{
  "info": {
    "name": "NaN 和 Infinity 处理测试",
    "description": "测试执行结果中 NaN 和 Infinity 的验证和错误处理",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "测试1: input为空 -> NaN",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "accessToken",
            "value": "{{access_token}}",
            "type": "text"
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"input\": {},\n  \"codebase64\": \"cmV0dXJuIHsgcmVzdWx0OiBpbnB1dC5hZ2UgKiAyLCBuYW1lOiBpbnB1dC5uYW1lLCBpdGVtczogaW5wdXQuaXRlbXMgfTs=\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/flow/codeblock",
          "host": ["{{base_url}}"],
          "path": ["flow", "codeblock"]
        },
        "description": "代码: `return { result: input.age * 2, name: input.name, items: input.items };`\n\n预期: 400 错误,提示字段 'result' 包含 NaN"
      },
      "response": []
    },
    {
      "name": "测试2: 直接返回 NaN",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "accessToken",
            "value": "{{access_token}}",
            "type": "text"
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"input\": {},\n  \"codebase64\": \"cmV0dXJuIHsgdmFsdWU6IE5hTiB9Ow==\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/flow/codeblock",
          "host": ["{{base_url}}"],
          "path": ["flow", "codeblock"]
        },
        "description": "代码: `return { value: NaN };`\n\n预期: 400 错误"
      },
      "response": []
    },
    {
      "name": "测试3: 返回 Infinity",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "accessToken",
            "value": "{{access_token}}",
            "type": "text"
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"input\": {},\n  \"codebase64\": \"cmV0dXJuIHsgdmFsdWU6IDEvMCB9Ow==\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/flow/codeblock",
          "host": ["{{base_url}}"],
          "path": ["flow", "codeblock"]
        },
        "description": "代码: `return { value: 1/0 };`\n\n预期: 400 错误,提示检测到 Infinity"
      },
      "response": []
    },
    {
      "name": "测试4: 返回 -Infinity",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "accessToken",
            "value": "{{access_token}}",
            "type": "text"
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"input\": {},\n  \"codebase64\": \"cmV0dXJuIHsgdmFsdWU6IC0xLzAgfTs=\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/flow/codeblock",
          "host": ["{{base_url}}"],
          "path": ["flow", "codeblock"]
        },
        "description": "代码: `return { value: -1/0 };`\n\n预期: 400 错误"
      },
      "response": []
    },
    {
      "name": "测试5: 嵌套对象中的 NaN",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "accessToken",
            "value": "{{access_token}}",
            "type": "text"
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"input\": {},\n  \"codebase64\": \"cmV0dXJuIHsgdXNlcjogeyBhZ2U6IGlucHV0LmFnZSAqIDIsIG5hbWU6ICd0ZXN0JyB9IH07\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/flow/codeblock",
          "host": ["{{base_url}}"],
          "path": ["flow", "codeblock"]
        },
        "description": "代码: `return { user: { age: input.age * 2, name: 'test' } };`\n\n预期: 400 错误,提示字段 'user': 字段 'age' 包含 NaN"
      },
      "response": []
    },
    {
      "name": "测试6: 数组中的 NaN",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "accessToken",
            "value": "{{access_token}}",
            "type": "text"
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"input\": {},\n  \"codebase64\": \"cmV0dXJuIHsgdmFsdWVzOiBbMSwgMiwgaW5wdXQuYWdlICogMiwgNF0gfTs=\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/flow/codeblock",
          "host": ["{{base_url}}"],
          "path": ["flow", "codeblock"]
        },
        "description": "代码: `return { values: [1, 2, input.age * 2, 4] };`\n\n预期: 400 错误,提示数组索引 [2] 包含 NaN"
      },
      "response": []
    },
    {
      "name": "测试7: 正常情况 - 应该成功",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "accessToken",
            "value": "{{access_token}}",
            "type": "text"
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"input\": {\n    \"age\": 25,\n    \"name\": \"张三\",\n    \"items\": [1, 2, 3, 4, 5]\n  },\n  \"codebase64\": \"cmV0dXJuIHsgcmVzdWx0OiBpbnB1dC5hZ2UgKiAyLCBuYW1lOiBpbnB1dC5uYW1lLCBpdGVtczogaW5wdXQuaXRlbXMgfTs=\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/flow/codeblock",
          "host": ["{{base_url}}"],
          "path": ["flow", "codeblock"]
        },
        "description": "代码: `return { result: input.age * 2, name: input.name, items: input.items };`\n\n预期: 200 成功,返回 `{ result: 50, name: \"张三\", items: [1,2,3,4,5] }`"
      },
      "response": []
    },
    {
      "name": "测试8: 安全写法 - 带默认值",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "accessToken",
            "value": "{{access_token}}",
            "type": "text"
          },
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"input\": {},\n  \"codebase64\": \"Y29uc3QgYWdlID0gaW5wdXQ/LmFnZSA/PyAwOwpyZXR1cm4geyByZXN1bHQ6IGFnZSAqIDIgfTs=\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/flow/codeblock",
          "host": ["{{base_url}}"],
          "path": ["flow", "codeblock"]
        },
        "description": "代码: \n```javascript\nconst age = input?.age ?? 0;\nreturn { result: age * 2 };\n```\n\n预期: 200 成功,返回 `{ result: 0 }`"
      },
      "response": []
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3002",
      "type": "string"
    },
    {
      "key": "access_token",
      "value": "your-access-token-here",
      "type": "string"
    }
  ]
}


