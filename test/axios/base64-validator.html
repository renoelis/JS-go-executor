<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base64 UTF-8 ç¼–ç éªŒè¯å™¨</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            max-width: 1000px;
            margin: 50px auto;
            padding: 20px;
        }
        textarea {
            width: 100%;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 10px 5px;
        }
        button:hover {
            background: #45a049;
        }
        .decode-btn {
            background: #2196F3;
        }
        .decode-btn:hover {
            background: #0b7dda;
        }
        .section {
            margin: 20px 0;
        }
        .label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        .info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .warning {
            background: #fff3e0;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #ff9800;
        }
        .success {
            background: #e8f5e9;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #4caf50;
        }
    </style>
</head>
<body>
    <h1>ğŸ“¦ Base64 UTF-8 ç¼–ç /è§£ç éªŒè¯å™¨</h1>
    
    <div class="info">
        <strong>ğŸ“Œ ä½¿ç”¨è¯´æ˜ï¼š</strong><br>
        1. å°†ä½ çš„ JavaScript ä»£ç ç²˜è´´åˆ°"åŸå§‹ä»£ç "æ¡†<br>
        2. ç‚¹å‡»"ç¼–ç ä¸º Base64"å¾—åˆ°æ­£ç¡®çš„ UTF-8 ç¼–ç <br>
        3. æˆ–è€…ç²˜è´´åœ¨çº¿å·¥å…·çš„ Base64 åˆ°"Base64 å­—ç¬¦ä¸²"æ¡†ï¼Œç‚¹å‡»"è§£ç éªŒè¯"æ£€æŸ¥æ˜¯å¦æ­£ç¡®
    </div>

    <div class="section">
        <div class="label">ğŸ“ åŸå§‹ä»£ç ï¼ˆæ”¯æŒ emoji å’Œä¸­æ–‡ï¼‰ï¼š</div>
        <textarea id="sourceCode" rows="15" placeholder="ç²˜è´´ä½ çš„ JavaScript ä»£ç ..."></textarea>
        <button onclick="encodeCode()">ğŸ”’ ç¼–ç ä¸º Base64ï¼ˆUTF-8 å®‰å…¨ï¼‰</button>
        <button onclick="loadSample()" style="background: #9e9e9e;">ğŸ“‹ åŠ è½½ç¤ºä¾‹ä»£ç </button>
    </div>

    <div class="section">
        <div class="label">ğŸ” Base64 å­—ç¬¦ä¸²ï¼š</div>
        <textarea id="base64Output" rows="10" placeholder="Base64 ç¼–ç ç»“æœä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
        <button onclick="copyBase64()">ğŸ“‹ å¤åˆ¶ Base64</button>
        <button class="decode-btn" onclick="decodeBase64()">ğŸ”“ è§£ç éªŒè¯</button>
    </div>

    <div class="section">
        <div class="label">âœ… è§£ç ç»“æœï¼ˆéªŒè¯ï¼‰ï¼š</div>
        <textarea id="decodedOutput" rows="10" placeholder="è§£ç åçš„ä»£ç ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ..." readonly></textarea>
    </div>

    <div id="statusMessage"></div>

    <script>
        function encodeCode() {
            const sourceCode = document.getElementById('sourceCode').value;
            
            if (!sourceCode.trim()) {
                showWarning('è¯·å…ˆè¾“å…¥ä»£ç ');
                return;
            }

            try {
                // ä½¿ç”¨ TextEncoder ç¡®ä¿ UTF-8 ç¼–ç 
                const encoder = new TextEncoder();
                const utf8Bytes = encoder.encode(sourceCode);
                
                // è½¬æ¢ä¸º base64
                let binary = '';
                const len = utf8Bytes.byteLength;
                for (let i = 0; i < len; i++) {
                    binary += String.fromCharCode(utf8Bytes[i]);
                }
                const base64 = btoa(binary);
                
                document.getElementById('base64Output').value = base64;
                
                // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
                showSuccess(
                    `âœ… ç¼–ç æˆåŠŸï¼\\n` +
                    `åŸå§‹å­—ç¬¦æ•°: ${sourceCode.length}\\n` +
                    `UTF-8 å­—èŠ‚æ•°: ${utf8Bytes.length}\\n` +
                    `Base64 é•¿åº¦: ${base64.length}`
                );
            } catch (error) {
                showWarning('ç¼–ç å¤±è´¥: ' + error.message);
            }
        }

        function decodeBase64() {
            const base64String = document.getElementById('base64Output').value;
            
            if (!base64String.trim()) {
                showWarning('è¯·å…ˆè¾“å…¥ Base64 å­—ç¬¦ä¸²');
                return;
            }

            try {
                // è§£ç  base64
                const binaryString = atob(base64String);
                const len = binaryString.length;
                const bytes = new Uint8Array(len);
                for (let i = 0; i < len; i++) {
                    bytes[i] = binaryString.charCodeAt(i);
                }
                
                // ä½¿ç”¨ TextDecoder è§£ç  UTF-8
                const decoder = new TextDecoder('utf-8');
                const decoded = decoder.decode(bytes);
                
                document.getElementById('decodedOutput').value = decoded;
                
                // éªŒè¯æ˜¯å¦ä¸åŸå§‹ä»£ç åŒ¹é…
                const original = document.getElementById('sourceCode').value;
                if (original && original === decoded) {
                    showSuccess('âœ… éªŒè¯é€šè¿‡ï¼ç¼–ç /è§£ç å®Œå…¨ä¸€è‡´');
                } else if (original) {
                    showWarning('âš ï¸ è­¦å‘Šï¼šè§£ç ç»“æœä¸åŸå§‹ä»£ç ä¸åŒ¹é…ï¼å¯èƒ½å­˜åœ¨ç¼–ç é—®é¢˜');
                } else {
                    showSuccess('âœ… è§£ç æˆåŠŸï¼');
                }
            } catch (error) {
                showWarning('è§£ç å¤±è´¥: ' + error.message + '\\nå¯èƒ½æ˜¯æ— æ•ˆçš„ Base64 å­—ç¬¦ä¸²');
            }
        }

        function copyBase64() {
            const base64Text = document.getElementById('base64Output');
            base64Text.select();
            document.execCommand('copy');
            showSuccess('âœ… Base64 å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
        }

        function loadSample() {
            const sample = `const axios = require('axios');

// æµ‹è¯• emoji å’Œä¸­æ–‡
console.log('ğŸ“‹ å¼€å§‹æ‰§è¡Œ');
console.log('â³ è¯·æ±‚ä¸­...');

const API_URL = 'https://api.qingflow.com/user/getId';

function getUserIds(emails) {
  console.log('âœ… æˆåŠŸ');
  return emails.join('|');
}

const emails = ["test@example.com"];
return getUserIds(emails);`;
            
            document.getElementById('sourceCode').value = sample;
            showSuccess('âœ… ç¤ºä¾‹ä»£ç å·²åŠ è½½ï¼ˆåŒ…å« emojiï¼‰');
        }

        function showSuccess(message) {
            const div = document.getElementById('statusMessage');
            div.className = 'success';
            div.innerHTML = message.replace(/\\n/g, '<br>');
        }

        function showWarning(message) {
            const div = document.getElementById('statusMessage');
            div.className = 'warning';
            div.innerHTML = message.replace(/\\n/g, '<br>');
        }
    </script>
</body>
</html>

